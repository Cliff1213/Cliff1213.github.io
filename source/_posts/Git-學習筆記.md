---
title: Git 常用指令與使用方式
date: 2022-01-20
tags:
 - [Git]
categories: "學習筆記"
---

紀錄一下這段時間天學習 Git 的一些看法，並紀錄一些相關筆記。（本篇內容待修飾）

<!--more-->

## 環境安裝：

在進入正題之前，必須先根據電腦的作業系統安裝 [Git](https://git-scm.com/) 的環境，安裝成功後在 Git 資料夾中會有 "Git Bash" 的應用程式，可以透過它來操作 Git 指令；或是使用電腦本身就有的命令提示字元 / 終端機也可以，依使用者習慣為主。

## Windows cmd 基本指令：

除了 Git 指令，通常還會搭配一些命令提示字元內建的原生指令去輔助操作，常用的 cmd 指令如下：

- ### **移動到指定目錄**

  **指令：**`cd 資料夾路徑`

  如果覺得直接輸入路徑很麻煩，可以直接將資料夾拖曳至 Git Bash 視窗中，這邊以我在桌面新增的資料夾 project 為例，輸入 "cd + 半形空白" 後將資料夾拖曳到視窗內，就會自動產生資料夾路徑 `cd /c/Users/user/Desktop/project`

  接著按下 Enter 後，當前位置就會變成該資料夾的路徑 `user@DESKTOP-LV1TU83 MINGW64 ~/Desktop/project`

- ### **展開當前目錄列表**

  **指令：**`ls`

  執行指令後，會列出當前目錄下的所有檔案。

- ### **回上一層目錄**

  **指令：**`cd ..`

  在當前目錄執行指令後，會回到上一層目錄。

- ### **新增資料夾**

  **指令：**`mkdir 資料夾名稱`

  執行指令後，會在當前目錄下建立一個資料夾，以建立檔名為 images 的資料夾為例，可以輸入 `mkdir images`

- ### **新增檔案**

  **指令：**`touch 檔案名稱.檔案類型`

  執行指令後，會在當前目錄建立一個檔案，以 test 文字檔為例，可以輸入 `touch test.txt`


## Git 版本檢視：

環境安裝完成後開啟 Git Bash，如果要確認是否安裝成功可以輸入 `$ git version` ，此時如果回饋 Git 版本內容 `git version 2.32.0.windows.2` 即表示安裝成功，版本內容依當下版本而定。

## Git 環境設定：

使用 Git 來進行版本控制時，每一個更新紀錄的更新者、更新時間以及一些詳細的內容都會被記錄；因此在開始使用 Git 之前需要先設定一些基本的資訊。

- ### **設定使用者暱稱**

  **指令：**`$ git config --global user.name "使用者暱稱"`

- ### **設定使用者信箱**

  **指令：**`$ git config --global user.email "使用者信箱"`

- ### **查看設定值**

  **指令：**`$ git config --list`

## Git 常用指令介紹：

Git 指令操作流程圖：

![](https://i.imgur.com/LZRD0Qg.png)

Git 的操作順序會根據不同情境而有所差異，但是原理基本上都相同；這邊開始先以本地端會使用到的指令說明，並且皆透過 Git Bash 來操作。

- ### **建立本地端資料庫**

  **指令：**`$ git init`

  資料庫（Repositiory）基本上就是用來存放一個專案所有檔案內容的資料夾。首先在任意目錄下新增一個資料夾，接著再開啟 Git Bash 並以該資料夾作為根目錄後輸入上述指令即可。

  送出指令後出現 `Initialized empty Git repository in C:/Users/user/Desktop/Git-test/.git/` 的訊息，表示已成功建立一個空的資料庫。

  

  此時可以發現當下目錄的路徑會變成 `user@DESKTOP-LV1TU83 MINGW64 ~/Desktop/Git-test (master)` ，這個 `(master)` 是資料夾在做 Git 初始化成功後所產生的預設分支（branch），可以用來判斷資料庫是否建立成功。

  

  另一個判斷方式則是可以開啟初始化的資料夾，查看根目錄是否多出一個 .git 的資料夾，它主要是用於監控與紀錄初始化資料夾內檔案的所有內容的變動；.git 資料夾預設是隱藏起來的，可以從資料夾上方列的"檢視"開啟隱藏的項目。

  *備註：為了方便閱讀，後續皆以"資料庫"來表示初始化的資料夾。*

- ### **檢查狀態**

  **指令：**`$ git status`

  用來查看資料庫裡的資料內容是否有做變更。

  

  這邊以 Project（本地端資料庫）為例，在初始化後透過指令查看狀態時，因為資料還沒有做任何編輯或修改，所以會出現以下訊息：

  `No commits yet`

  `nothing to commit (create/copy files and use "git add" to track)` 

  第一段表示還沒有任何提交（commit）紀錄，第二段則是沒有資料可以提交。

  

  現在嘗試在資料庫的根目錄新增一個檔案 index.html，再透過指令查看狀態會得到以下訊息：

  `Untracked files:`

  　　`(use "git add <file>..." to include in what will be committed)`

  　　　　`index.html`

  第一段表示找到尚未加入索引的檔案，第三段則是資料庫的更動（新增了 index.html），因為新增的檔案還沒加入索引，所以通常會以紅色表示。

- ### **加入索引**

  **指令：**`$ git add .`

  資料庫內的資料如果有因為新增或編輯，就可以使用指令將編輯的檔案加入索引。

  

  這邊用前面新增的檔案 index.html 為例，原本的狀態是偵測到有新增的檔案，但還沒加入索引；接著輸入 `$ git add .` 指令後並不會顯示任何訊息，但是透過 `$ git status` 來查看目前的狀態時會出現以下訊息：

  `Changes to be committed:`

  　　`(use "git rm --cached <file>..." to unstage)`

  　　　　`new file:   index.html`

  第一段表示資料的變更已經被存放在暫存區準備提交，第三段則是被加入索引的檔案，通常會以綠色表示。

  `$ git add .` 指令是將所有變更過內容的檔案加入索引，但如果要單獨將一個檔案加入索引可以輸入 `$ git add 檔案名稱.檔案類型` 來將單一檔案加入索引。

- ### **提交更新**

  **指令：**`$ git commit -m "修改內容說明"`

  將所有變更過內容的檔案加入索引後，就可以透過該指令來提交此次的修改紀錄。
  
  
  
  這邊用前面加入索引的 index.html 為例，輸入 `$ git commit -m "新增 index 檔案"` 提交本次更新後，會出現以下訊息：
  
  `[master (root-commit) 4547fe0] add index`
  
   `1 file changed, 0 insertions(+), 0 deletions(-)`
  
   `create mode 100644 index.html`
  
  看到上述訊息並且沒有出現錯誤時，表示已經成功提交本次修改紀錄。
  
  完成提交後使用 `git status` 來查詢目前狀態時，會出現 `nothing to commit, working tree clean` 的訊息，表示索引內也沒有任何檔案可以提交；但是如果提交後編輯了 index.html 檔案的內容，再次查詢狀態就會出現 `modified:　index.html` 的訊息，表示這個檔案在最新一次提交後有編輯過，通常會以紅色表示。
  
  
  
- ### **查詢提交紀錄**

  **指令：**`$ git log`

  可以使用該指令來查看詳細的歷史提交紀錄。

  

  這邊用先前提交的 index.html 為例，使用 `$ git log` 查詢紀錄時會出現以下訊息，依序分別表示當次的提交序號、提交人的資訊、提交當下的時間以及提交時輸入的內容，可以輸入 "q" 來退出畫面。

  `commit 4547fe0f2038054ba2bd2491a7988d0f6d72a900 (HEAD -> master)`

  `Author: Username <useremail@gmail.com>`

  `Date:   Thu Jan 20 22:57:59 2022 +0800`

  　　`新增 index 檔案`

- ### **忽略檔案**

  如果不希望某些檔案被 git 追蹤，可以新增一個 ".gitignore" 的檔案；透過程式碼編輯器將這個檔案開啟後，直接輸入希望被忽略的檔案名稱和檔案類型，這樣後續 git 在追蹤資料庫時，.gitignore 裡面的檔案就會被忽略，但是 .gitignore 檔案本身不會被忽略。

  檔案的輸入格式分別有以下幾種，這邊以 index.html 檔案為例：

  **忽略單一檔案**

  輸入格式：`index.html`

  **忽略檔案類型**

  輸入格式：`*.html`

  **忽略單一資料夾**

  輸入格式：`html/`

- ### **取消加入索引**

  加入索引後如果想取消這個動作時，可以使用的指令，又分為下列幾種：

  **取消單一檔案加入索引**

  指令：`$ git reset HEAD 檔案名稱`

  **取消所有檔案加入索引**

  指令：`$ git reset HEAD`

- ### 還原檔案資料內容

  資料庫的內容在變動後，如果想將資料庫恢復到最後一次提交（commit）的狀態時，可以視情況使用以下幾個指令：

  **還原單一檔**

  指令：`$ git checkout 檔案名稱.檔案類型`

  **還原工作目錄與索引**

  指令：`$ git reset --hard`

  在還原資料時要注意的是，如果使用指令後發現有空的資料夾沒有被還原也不需要緊張，因為空的資料夾本身就會被 git 忽略，但是如果資料夾內有新增檔案，就會被 git 追蹤並還原。

- ### 刪除提交紀錄

  刪除提交紀錄的相關指令分別為以下幾種：

  **刪除最後一次的提交紀錄**

  指令：`$ git reset --hard HEAD^`

  假設使用 `$ git log` 查詢後，顯示的提交紀錄有兩個（如下方所示），可以看到最後一次提交紀錄的訊息是 `add all.js`，此時使用指令 `$ git reset --hard HEAD^` 後，該次提交紀錄就會被刪除，並顯示 `HEAD is now at 39095f4 add index` 訊息，表示目前的位置 `（HEAD）` 移動到提交訊息為 `add index` 的紀錄點上，也可以再次輸入 `$ git log` 來查看紀錄，會發現原本最後一次的提交紀錄已不存在。

  `$ git log`

  `commit 3d672e0a32c8075eb9eb13442105b4a27f88b4c0 (HEAD -> master)`

  `Author: Username <useremail@gmail.com>`

  `Date:   Fri Jan 21 18:39:24 2022 +0800`

  　　`add all.js`

  

  `commit 39095f489c57155948cff361b19eba1dcbd18d65`

  `Author: Username <useremail@gmail.com>`

  `Date:   Fri Jan 21 00:52:44 2022 +0800`

  　　`add index`

  

  **還原刪除的最後一次提交紀錄**

  指令：`$ git reset --hard ORIG_HEAD`

  輸入該指令就會還原 `$ git reset --hard HEAD^` 所做的所有事情。

  **刪除最後一次的提交紀錄時保留異動內容**

  指令：`$ git reset --soft HEAD^ `

  可以理解成沒有做最後一次提交的動作，並保留提交前的所有狀態。

  **提交後想補充內容（內容待補充）**

  指令：`$ git commit --amend`

## 分支介紹

分支（branch）是開發者在團隊協作一個專案時，會需要使用到的 Git 架構內容；可以理解成將現階段資料庫的所有內容複製一份，而這兩個版本可以獨立修改各自的內容。而這樣的好處是如果資料庫的內容需要做更動，就可以先建立一個分支並在該分支上做修改，同時也不用擔心影響到原本的資料庫。

在開始介紹分支之前，要先理解什麼是 HEAD；當資料庫剛初始化建立時，因為還沒有做任何的變動，所以沒有提交（commit）的紀錄，這邊以 Project（新建的資料庫）為例，在 Git Bash 視窗內可以看到以下資訊：

`user@DESKTOP-LV1TU83 MINGW64 ~/Desktop/Project (master)`

上述可以看到除了資料庫的路徑以外，後面有一個 `（master）` 字樣，而這就是資料庫在初始化後，預設產生的本地端主要分支；如果這時新增一個 index.html 檔案並加入索引提交，當前的位置也就是 HEAD 就會移動到這個提交紀錄點上，因此可以理解成 HEAD 代表目前分支上，最後一次提交（commit）紀錄的位置；也可以使用指令 `$ git branch` 查看，執行指令後可以看到 `* master` 的內容，星號表示目前 HEAD 所在的分支。

- ### 檢視當前所有分支

  **指令：**`$ git branch`

  該指令可以查詢目前本地端資料庫所有的分支，以及 HEAD 所在的分支，而 HEAD 所在的分支前面會有星號標示，從下面的例子可以得知目前資料庫有兩個分支，並且 HEAD（星號）目前指向 `master` 分支。

  `develop`

  `* master`

- ### **切換 HEAD 到指定提交紀錄**

  **指令：**`$ git checkout 提交記錄編號（前 4 碼）`

  如果希望查看某一次的提交紀錄的資料內容，可以使用上述指令；提交記錄編號可以透過 `$ git log` 來查詢，以下方提交紀錄為例，輸入指令 `$ git checkout 950e` 即可切換 HEAD 到該次提交紀錄，如果檢視完資料內容後要還原 HEAD 到原本位置，可以輸入 `$ git checkout 當前分支名稱`。

  `commit 950e30f1c1d82d5f0239c750c0759fafbed6c1f7`

  `Author: Username <useremail@gmail.com>`

  `Date:   Fri Jan 21 22:53:07 2022 +0800`

  　　`add index`

- ### 建立分支

  **指令：**`$ git branch 分支名稱`

  上述指令只是建立一個新的分支，但是 HEAD 的指向不變。

- ### 切換分支

  **指令：**`$ git checkout 分支名稱`

  執行該指令後，HEAD 的指向就會切換到指定的分支上。

- ### 合併分支 

  在進行分支的合併時，視情況又分為以下兩種合併模式：

  **快轉模式（Fast-Forward）**

  **指令：**`$ git merge 合併的分支名稱`

  執行該指令後，HEAD 的位置會移動到兩個分支合併後產生出來的新提交紀錄（commit）上。

  這裡要注意的是，當合併時兩個分支的最後提交紀錄是同一個位置，就會產生快轉模式（Fast - Forward），以下面這張圖為例：

  ![](https://i.imgur.com/uRzQ0zw.png)

  圖中左邊的部分為主分支（master）與次要分支（feature）合併前的狀態；可以得知次要分支的提交紀錄有兩個，先後依序為 add css 與 add js，而主分支沒有做更動；接著將 HEAD 切換回主分支並且執行指令 `$ git merge feature` 後，狀態變成右邊的部分，可以發現合併後主分支的位置移動到次要分支 add js 的提交紀錄上，也就是說兩個分支的差異只是次要分支多了兩個提交紀錄而已，因為兩者都是同一個提交紀錄分出去的，所以主分支有的內容次要分支也都有；因此主分支只是在與自己未來的版本合併而已，而這種合併模式就稱為 "快轉模式（Fast - Forward）"。

  **非快轉模式（--no-ff）**

  **指令：**`$ git merge 合併的分支名稱 --no-ff`

  前面提到分支在合併時，如果兩者最後一次的提交紀錄在相同位置上，合併時就會進行快轉模式；雖然兩者最後都會合併到同一個提交紀錄上，但是以開發者的角度來思考，都會盡可能的區隔每個分支所做的工作，而這也是分支的意義；因此如果要更明確的區隔兩個分支，在合併時就可以使用指令 `$ git merge 合併的分支名稱 --no-ff`，來關閉快轉模式；以下面這張圖為例：

  ![](https://i.imgur.com/KFo2foP.png)

  圖中左邊的部分所做的事情與前一張圖是相同的，但是兩個分支在關閉快轉模式進行合併時，可以發現主分支與次要分支合併後，自己產生出一個新的提交紀錄，但是次要分支並沒有與主分支重疊，並且進行路線停留在合併前最後一次提交紀錄 add js 上，而這種合併模式就稱為 ＂非快轉模式＂。

  這裡補充說明一點，使用指令 `$ git merge 合併的分支名稱 --no-ff` 來合併兩個分支時，有時候會出現以下的訊息：

  ![](https://i.imgur.com/6MWIo44.png)

  如果跳出上面圖片中的訊息，代表需要你輸入合併的原因；此時可以按下鍵盤 " i " 進入輸入模式，接著把黃色文字的部分改成合併的簡單說明，輸入完後再按下鍵盤 " Esc " 退出輸入模式，最後在最下方輸入 `：wq` 即可回到原來的 git 畫面。

  **手動合併（衝突）**

  在團隊協作開發專案時，可能會遇到

## 標籤

開發一個專案的過程中，資料庫會因為內容會不斷新增、編輯或修改而增加許多提交紀錄（commit），雖然每個紀錄都有自己的提交訊息，但是這樣很難去區分彼此之間的重要程度，像是某次重要的檔案編輯或是不同時期的上線版本；因此為了區分重要程度，可以使用標籤的指令。

- ### 加入標籤

  **指令：**`$ git tag 標籤名稱`

  執行該指令後，可以在當下的提交紀錄上新增一個標籤；後續如果要查詢標籤時，可以輸入 `$ git tag` 來做查詢。

- ### 新增標示標籤

  **指令：**`$ git tag -am "標示內容" 標籤名稱`

  執行該指令後，除了可以在當下的提交紀錄上新增一個標籤之外，還能加上一些詳細的描述；但如果要查詢標籤詳細的標示內容，就要透過 `$ git tag -n` 來做查詢。

- ### 切換至標籤位置

  **指令：**`$ git checkout 標籤名稱`

  執行該指令後，HEAD 的位置就會移動到指定標籤的提交紀錄上；以標籤 `version_1` 為例，執行 `$ git checkout version_1` 後，當前路徑的內容就會變成 `user@DESKTOP-LV1TU83 MINGW64 ~/Desktop/Project ((version_1))`，表示 HEAD 的位置目前在 `version_1` 的標籤上，如果要切換回原本的位置，可以輸入指令 `$ git checkout 分支名稱` 即可。

## 暫存

在團隊開發專案的過程中，偶爾會開發到一半時出現臨時的狀況要處理，其中一種作法是，先將目前的工作內容加入索引並提交（commit）成一個紀錄，後續回來再透過指令 `$ git reset --soft HEAD^` 將最後一次提交記錄的動作刪除，同時保留當時提交前的所有狀態；而另一種方式，則是透過接下來要介紹的指令 `$ git stash` 來暫存檔案內容。

- ### 暫存當前的目錄

  **指令：**`$ git stash`

  執行該指令後，當前有被加入索引的檔案內容，無論有沒有編輯都會被暫存起來，暫存目錄後也可以透過指令 `$ git status` 來查看目前狀態，會顯示訊息 `nothing to commit, working directory clean` ，表示當前目錄沒有任何有變更或可以提交的檔案內容。

- ### 檢視暫存列表

  **指令：**`$ git stash list`

  被暫存的目錄可以使用該指令來查詢，並且會以列表的方式依序顯示，訊息格式如下方所示：

  `stash@{0}: WIP on master: 7870371 add index`

- ### 還原暫存的目錄

  **指令：**`$ git stash pop`

  使用該指令可以將暫存的目錄還原到當前分支上，有搬運暫存目錄的功能。

- ### 清除最新暫存

  **指令：**`$ git stash drop`

  執行該指令後，最後一次的暫存目錄會被移除並無法還原。

- ### 清除全部暫存

  **指令：**`$ git stash clear`

  執行該指令後，暫存列表所有的暫存紀錄都會被移除。

## 遠端資料庫操作指令

這邊開始會介紹到推送本地端資料到遠端資料庫時，會用到的指令；這篇筆記內容主要是著重在講述 Git 的基本操作，因此先不討論遠端資料庫的建立方式與相關內容。

- ### 複製遠端資料庫

  **指令：**`$ git clone 遠端資料庫網址`

  執行指令後，遠端資料庫內容會複製一份到本地端，並建立工作目錄與本地端資料庫（.git 資料夾），這個指令通常使用在本地端還沒有遠端的資料時，而後續的資料更新都是透過下面會介紹到的指令 `$ git pull` 來操作。

- ### 查詢遠端資料庫

  **指令：**`$ git remote`

  當遠端資料庫內容被複製一份到本地端時，可以只用上述指令來查詢遠端資料庫的名稱，預設為 "origin"，通常也用來代表遠端資料庫的 URL 路徑。

- ### 推送本地端分支至遠端分支

  **指令：**`$ git push 遠端資料庫路徑 遠端分支名稱`

  這裡要注意的是，上述指令在第一次推送資料時，建議輸入成 `$ git push -u 遠端資料庫路徑 遠端分支名稱` ，這樣做的話 git 就會把這次的推送行為紀錄起來，這樣之後在推送本地端資料到遠端時，只需要輸入指令 `$ git push` 即可；但是也可能會遇到無法推送的情形，這個會在後面 `$ git pull` 的地方說明。

- ### 變更遠端資料庫名稱

  **指令：**`$ git remote rename 原始資料庫名稱 修改後名稱`

  先前有提到，當遠端資料庫複製到本地端時，預設的遠端資料庫名稱為 " origin "；但是也可以透過上述指令來變更遠端資料庫的預設名稱，但是要注意變更後如果要推送本地端資料到遠端，遠端資料庫的路徑就要改成修改後的名稱，假設修改後的名稱為 "myblog"，推送指令就要輸入 `$ git push -u myblog 遠端分支名稱` 。

- ### 將遠端資料庫分支拉下至本地端分支並合併

  **指令：**`$ git pull`

  團隊協作開發專案時，因為每個人的進度不同，常常會需要將遠端最新的資料內容更新到本地端，這種情況就會使用到上述指令，與前面提到的指令 `$ git clone` 不同的是， `$ git pull` 是使用在本地端已經下載過遠端資料庫的資料，但是需要做更新時。

  前面 `$ git push` 的地方有提到，偶爾在推送本地端資料庫回遠端時，會遇到無法推送的情況；通常造成此情形的原因可能是遠端資料庫有更新，導致本地端在推送時產生衝突，以下列出在推送時可能會出現錯誤訊息：

  ![](https://i.imgur.com/WYOmVjP.png)

  

  左圖是推送本地端資料到遠端時，因為遠端資料庫有做更動而出現推送被拒絕的訊息，此時需要使用 `$ git pull` 將本地端做資料更新，而執行指令後可能會出現右圖的訊息，主要是在要求遠端資料庫與本地端做合併（merge）分支的動作；由此可知，指令 `$ git pull` 所做的事情是將遠端分支複製一份到本地端，並做合併的動作。

  

## 參考資料

- [如何使用 --amend 追加檔案](https://gitbook.tw/chapters/using-git/amend-commit2)
- [Fast-Forward 快轉模式詳細介紹](https://ithelp.ithome.com.tw/articles/10211795)
- [Git Reset 使用模式](https://gitbook.tw/chapters/using-git/reset-commit)
- [Clone 與 Pull 差異](https://gitbook.tw/chapters/github/clone-vs-pull)
